#!/usr/bin/env bash

maintenance(){
[ $1 == on ] && status=true || status=false
curl -n -X PATCH https://api.heroku.com/apps/mighty-mesa-44488 \
  -d "{ \"maintenance\": $status}" \
  -H "Content-Type: application/json" \
  -H "Accept: application/vnd.heroku+json; version=3" \
  -H "Authorization: Bearer ea7c33bb-a873-4bf1-9219-23b47b871e83"
}

echo "I've been run during release!!!"
echo "Below there are environment variables:"
env
echo "Starting some long process..."
maintenance on
echo "Enabing maintenance mode"
echo "Waiting till 10..."
for i in {1..10}
do
	sleep 5s
	echo -n "$i."
done
maintenance off
echo "Maintenance mode has disabled"
echo
echo "All done. We gonna go forward..."

